package com.progetto_sicurezza.ui;

import java.io.FileOutputStream;
import java.io.IOException;
import java.io.OutputStreamWriter;
import java.sql.SQLException;

import com.progetto_sicurezza.dao.AntiMalwareDao;
import com.progetto_sicurezza.dao.MalwareDao;
import com.progetto_sicurezza.model.AntiMalware;
import com.progetto_sicurezza.model.Malware;

public class HtmlSearcher
{
	
final static String CHAR_ENCODING = "UTF-8";
	
	public static void searchMalwareById(int idMalware) throws SQLException, IOException
	{
		if(idMalware <= 0) throw new IllegalArgumentException();

		Malware mal = new MalwareDao().getMalwareById(idMalware);
		
		printHtml(mal,"malwareById");
	
	}
	
	public static void searchMalwareByStrId(String strId) throws SQLException, IOException
	{
		if(strId == null) throw new IllegalArgumentException();

		Malware mal = new MalwareDao().getMalwareByStrIdentifier(strId);
		
		printHtml(mal,"malwareByStrId");
	}
	
	
	public static void searchAntimalwareById(int idAntimalware) throws SQLException, IOException
	{
		if(idAntimalware <= 0) throw new IllegalArgumentException();

		AntiMalware antimal = new AntiMalwareDao().getAntiMalwareById(idAntimalware);
		
		printHtml(antimal,"antimalwareById");
	}
	
	public static void searchAntimalwareByName(String name) throws SQLException, IOException
	{
		if(name == null) throw new IllegalArgumentException();

		AntiMalware antimal = new AntiMalwareDao().getAntiMalwareByName(name);
		
		printHtml(antimal,"antimalwareByName");
	}
	
	/*
	 * stampa
	 */
	private static void printHtml(Object obj,String fileName) throws IOException
	{
		StringBuffer sb = new StringBuffer();
		
		// print description of table
		String cssStyle = "<style> table, td, th { " +
                          "border: 1px solid green;} " +
                          "th { background-color: green; " +
                          "color: white; }" +
                          "</style> ";
		
		sb.append("<html>");
		sb.append("<head>");
		sb.append(cssStyle);
		sb.append("<meta charset=\"UTF-8\">");
	    sb.append("</head>");
		
		sb.append("<body>");
		
		sb.append("<h3>Description</h3>");
		sb.append("<br>");
		
		if(obj != null)
		sb.append(obj.toString());
		else
	    sb.append("NOT FOUND");	

		sb.append("</body>");
		sb.append("</html>");
		
		//rewrite file
		FileOutputStream fos = new FileOutputStream(fileName + ".html");
		OutputStreamWriter out = new OutputStreamWriter(fos, CHAR_ENCODING);
		out.append(sb.toString());
		out.close();
	}
}
